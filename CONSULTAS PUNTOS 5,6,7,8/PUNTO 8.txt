--Consulta de todos los clientes que han tenido más de un(1) mantenimiento en los últimos 30 días.
SELECT A.CLIENTE_ID, (SELECT C.PRIMER_NOMBRE || ' ' || C.PRIMER_APELLIDO FROM HYSOTELO.CLIENTE C WHERE C.ID = A.CLIENTE_ID)NOMBRE_CLIENTE ,A.TOTAL_MANTENIMIENTOS
FROM
(SELECT DISTINCT M.CLIENTE_ID, COUNT(M.ID) TOTAL_MANTENIMIENTOS
FROM HYSOTELO.FACTURA FA, HYSOTELO.MANTENIMIENTO M
WHERE FA.ESTADO = 'A' AND TO_DATE(FA.FECHA_EMISION,'DD/MM/YYYY') >=  (SELECT TO_DATE(SYSDATE-30,'DD/MM/YYYY') FROM DUAL)
AND M.ID = FA.MANTENIMIENTO_ID  AND M.ESTADO = 'TERMINADO'
GROUP BY M.CLIENTE_ID)A
