--Consulta de los 100 productos más vendidos en los últimos 30 días
SELECT A.PRODUCTO_ID, SUM(A.UNIDADES) CANTIDAD
FROM
(SELECT DISTINCT DM.PRODUCTO_ID ,  DM.UNIDADES
FROM
(SELECT DISTINCT FA.ID, FA.MANTENIMIENTO_ID
FROM HYSOTELO.FACTURA FA
WHERE FA.ESTADO = 'A' AND TO_DATE(FA.FECHA_EMISION,'DD/MM/YYYY') >=  (SELECT TO_DATE(SYSDATE-30,'DD/MM/YYYY') FROM DUAL))A, HYSOTELO.MANTENIMIENTO M,HYSOTELO.DETALLE_MANTENIMIENTO DM
WHERE A.MANTENIMIENTO_ID = M.ID AND DM.MANTENIMIENTO_ID = M.ID 
GROUP BY DM.PRODUCTO_ID, DM.UNIDADES)A
WHERE ROWNUM <= 100
GROUP BY A.PRODUCTO_ID
ORDER BY CANTIDAD DESC
